% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calibration_cycle2.R
\name{calibrate_cT_cR_cS_kappa_fn}
\alias{calibrate_cT_cR_cS_kappa_fn}
\title{Calibrate Multiple Monitoring Parameters for Multi-Stage Dose-Finding Design}
\usage{
calibrate_cT_cR_cS_kappa_fn(
  cT_candidate = c(0.5, 0.6, 0.7),
  cR_candidate = c(0.6, 0.7, 0.8),
  cS_candidate = c(0.7, 0.8, 0.9),
  kappa_candidate = c(0.2, 0.3, 0.4),
  monitor_cutoff_B = 0.4,
  ntrial = 1000,
  true_OTD_sim = c(6, 5, 3, 2),
  doses = c(0.05, 0.1, 0.2, 0.45, 0.65, 0.85),
  Y_B_sim = list(c(2, 2.01, 2.08, 2.76, 3.75, 4.73), c(2.01, 2.09, 2.24, 4.46, 5.29,
    5.95), c(2.24, 4, 5.77, 5.99, 6, 6), c(5.04, 5.83, 5.98, 6, 6, 6)),
  Y_T_sim = list(c(0.01, 0.02, 0.03, 0.06, 0.13, 0.26), c(0.01, 0.03, 0.04, 0.07, 0.14,
    0.28), c(0.01, 0.02, 0.05, 0.1, 0.27, 0.55), c(0.01, 0.06, 0.18, 0.29, 0.51, 0.54)),
  Y_R_sim = list(c(0.04, 0.05, 0.08, 0.2, 0.35, 0.47), c(0.04, 0.06, 0.09, 0.23, 0.37,
    0.44), c(0.07, 0.14, 0.32, 0.41, 0.42, 0.44), c(0.22, 0.38, 0.41, 0.42, 0.44, 0.45)),
  lambdaT_sim = list(c(0.8, 0.6, 0.6, 0.25, 0.2, 0.1), c(0.8, 0.4, 0.3, 0.3, 0.2, 0.35),
    c(0.4, 0.1, 0.1, 0.3, 0.3, 0.3), c(0.12, 0.1, 0.2, 0.3, 0.3, 0.3)),
  sigma2_B_sim = c(1, 1, 1, 1),
  delta1_sim = c(3, 3, 3, 3),
  delta2_sim = c(-2, -2, -2, -2),
  delta3_sim = c(0, 0, 0, 0),
  shape_sim = c(1.5, 1.5, 1.5, 1.5),
  censored_time = 24,
  RMST_followup = 12,
  cohort_stage1 = 10,
  cohortsize_stage1 = 3,
  cohort_stage2 = 3,
  cohortsize_stage2 = 3,
  M = 24,
  target_toxicity = 0.3,
  min_acceptable_ORR = 0.2,
  min_acceptable_PFS = 3,
  L1 = 3,
  L2 = 4
)
}
\arguments{
\item{cT_candidate}{A numeric vector of candidate toxicity cutoff (cT) values to test. \strong{Default:} \code{c(0.5, 0.6, 0.7)}}

\item{cR_candidate}{A numeric vector of candidate response cutoff (cR) values to test. \strong{Default:} \code{c(0.6, 0.7, 0.8)}}

\item{cS_candidate}{A numeric vector of candidate survival cutoff (cS) values to test. \strong{Default:} \code{c(0.7, 0.8, 0.9)}}

\item{kappa_candidate}{A numeric vector of candidate plateau parameter (kappa) values to test. \strong{Default:} \code{c(0.2, 0.3, 0.4)}}

\item{monitor_cutoff_B}{A numeric scalar specifying the biomarker cutoff value. \strong{Default:} \code{0.4}}

\item{ntrial}{An integer specifying the number of simulation trials. \strong{Default:} \code{1000}}

\item{true_OTD_sim}{A numeric vector of true optimal therapeutic doses for each simulation scenario. \strong{Default:} \code{c(6, 5, 3, 2)}}

\item{doses}{A numeric vector of candidate dose levels. \strong{Default:} \code{c(0.05, 0.10, 0.20, 0.45, 0.65, 0.85)}}

\item{Y_B_sim}{A list of numeric vectors of true mean biomarker responses for each simulation scenario. \strong{Default:} \code{list(c(2.00, 2.01, 2.08, 2.76, 3.75, 4.73), c(2.01, 2.09, 2.24, 4.46, 5.29, 5.95), c(2.24, 4.00, 5.77, 5.99, 6.00, 6.00), c(5.04, 5.83, 5.98, 6.00, 6.00, 6.00))}}

\item{Y_T_sim}{A list of numeric vectors of true toxicity probabilities for each simulation scenario. \strong{Default:} \code{list(c(0.01, 0.02, 0.03, 0.06, 0.13, 0.26), c(0.01, 0.03, 0.04, 0.07, 0.14, 0.28), c(0.01, 0.02, 0.05, 0.10, 0.27, 0.55), c(0.01, 0.06, 0.18, 0.29, 0.51, 0.54))}}

\item{Y_R_sim}{A list of numeric vectors of true response probabilities for each simulation scenario. \strong{Default:} \code{list(c(0.04, 0.05, 0.08, 0.20, 0.35, 0.47), c(0.04, 0.06, 0.09, 0.23, 0.37, 0.44), c(0.07, 0.14, 0.32, 0.41, 0.42, 0.44), c(0.22, 0.38, 0.41, 0.42, 0.44, 0.45))}}

\item{lambdaT_sim}{A list of numeric vectors of baseline hazard scale parameters for each simulation scenario. \strong{Default:} \code{list(c(0.80, 0.60, 0.60, 0.25, 0.20, 0.10), c(0.80, 0.40, 0.30, 0.30, 0.20, 0.35), c(0.40, 0.10, 0.10, 0.30, 0.30, 0.30), c(0.12, 0.10, 0.20, 0.30, 0.30, 0.30))}}

\item{sigma2_B_sim}{A numeric vector of true biomarker variances for each simulation scenario. \strong{Default:} \code{c(1, 1, 1, 1)}}

\item{delta1_sim, delta2_sim, delta3_sim}{Numeric vectors of hazard function parameters for time-to-event modeling for each simulation scenario. \strong{Defaults:} \code{c(3, 3, 3, 3)}, \code{c(-2, -2, -2, -2)}, and \code{c(0, 0, 0, 0)}, respectively}

\item{shape_sim}{A numeric vector of Weibull shape parameters for each simulation scenario. \strong{Default:} \code{c(1.5, 1.5, 1.5, 1.5)}}

\item{censored_time}{A numeric scalar specifying the administrative censoring time (in months). \strong{Default:} \code{24}}

\item{RMST_followup}{A numeric scalar specifying the restricted mean survival time follow-up period (in months). \strong{Default:} \code{12}}

\item{cohort_stage1}{An integer specifying the number of cohorts in stage 1. \strong{Default:} \code{10}}

\item{cohortsize_stage1}{An integer specifying the cohort size in stage 1. \strong{Default:} \code{3}}

\item{cohort_stage2}{An integer specifying the number of cohorts in stage 2. \strong{Default:} \code{3}}

\item{cohortsize_stage2}{An integer specifying the cohort size in stage 2. \strong{Default:} \code{3}}

\item{M}{An integer specifying the maximum sample size. \strong{Default:} \code{24}}

\item{target_toxicity}{A numeric scalar specifying the target toxicity rate. \strong{Default:} \code{0.30}}

\item{min_acceptable_ORR}{A numeric scalar specifying the minimum acceptable overall response rate. \strong{Default:} \code{0.20}}

\item{min_acceptable_PFS}{A numeric scalar specifying the minimum acceptable progression-free survival (in months). \strong{Default:} \code{3.0}}

\item{L1, L2}{Numeric scalars specifying look-back periods for toxicity and response evaluation (in months). \strong{Defaults:} \code{3} and \code{4}, respectively}
}
\value{
A \code{list} with elements:
\describe{
\item{\code{best_cT}}{The cT value that maximizes the composite index.}
\item{\code{best_cR}}{The cR value that maximizes the composite index.}
\item{\code{best_cS}}{The cS value that maximizes the composite index.}
\item{\code{best_kappa}}{The kappa value that maximizes the composite index.}
}
}
\description{
\code{calibrate_cT_cR_cS_kappa_fn()} calibrates the monitoring cutoff parameters (cT, cR, cS) and plateau parameter (kappa) for a multi-stage dose-finding trial by:
\enumerate{
\item Running multiple simulations using the DEMO design for dose exploration.
\item Evaluating the probability of correct selection (PCS) and sample size across candidate parameter combinations.
\item Returning the optimal cT, cR, cS, and kappa values based on a composite index.
}
}
\details{
This function evaluates combinations of candidate cT, cR, cS, and kappa values by simulating trials with the DEMO design,
calculating the probability of correct selection (PCS) of the optimal therapeutic dose (OTD) and the average sample size,
and determining optimal parameter values that maximize a composite index (PCS / sqrt(sample size)). It assumes the existence
of a helper function \code{DEMO_design()} for trial simulation.
}
\examples{
\dontrun{
  # Run with reduced parameters for demonstration
  set.seed(123)
  result <- calibrate_cT_cR_cS_kappa_fn(
    ntrial = 1000,
    cT_candidate = c(0.5, 0.6, 0.7),
    cR_candidate = c(0.6, 0.7, 0.8),
    cS_candidate = c(0.7, 0.8, 0.9),
    kappa_candidate = c(0.2, 0.3, 0.4)
  )

  # Check optimal parameter values
  print(result$best_cT)
  print(result$best_cR)
  print(result$best_cS)
  print(result$best_kappa)
}

}
